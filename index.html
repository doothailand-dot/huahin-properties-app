<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>HUAHIN.PROPERTIES</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <style>
        :root { --line-green: #06c755; --bg-light: #f4f7f6; }
        body { font-family: 'Kanit', sans-serif; background-color: var(--bg-light); margin-bottom: 80px; }
        .header-nav { background-color: var(--line-green); color: white; padding: 15px; text-align: center; font-weight: bold; position: sticky; top: 0; z-index: 1000; }
        .prop-item { background: white; border-bottom: 1px solid #eee; padding: 15px; display: flex; align-items: center; }
        .thumb { width: 85px; height: 85px; border-radius: 12px; object-fit: cover; margin-right: 15px; }
        .info { flex-grow: 1; }
        .price { color: var(--line-green); font-weight: bold; font-size: 1.1rem; }
        .footer-nav { position: fixed; bottom: 0; width: 100%; background: white; border-top: 1px solid #ddd; display: flex; padding: 10px 0; z-index: 1000; }
        .nav-btn { flex: 1; text-align: center; color: #888; text-decoration: none; font-size: 0.7rem; }
        .nav-btn.active { color: var(--line-green); }
        .nav-btn i { font-size: 1.5rem; display: block; }
        #loginPage { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #121212; z-index: 9999; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>
    <div id="loginPage">
        <div class="p-4 bg-dark text-white rounded-4 shadow text-center" style="width:320px;">
            <h4 class="mb-4">เข้าสู่ระบบ</h4>
            <input type="tel" id="u" class="form-control mb-2" placeholder="เบอร์โทรศัพท์">
            <input type="password" id="p" class="form-control mb-4" placeholder="รหัสผ่าน">
            <button class="btn btn-warning w-100 fw-bold" onclick="login()">เข้าใช้งาน</button>
        </div>
    </div>

    <div id="app" style="display:none;">
        <div class="header-nav shadow-sm">HUAHIN.PROPERTIES</div>
        <div id="list"></div>
        <div class="footer-nav shadow">
            <a href="#" class="nav-btn active"><i class="bi bi-house-door-fill"></i>สต็อก</a>
            <a href="#" class="nav-btn"><i class="bi bi-calendar-check"></i>นัดหมาย</a>
            <a href="#" class="nav-btn"><i class="bi bi-pencil-square"></i>เช็คอิน</a>
            <a href="javascript:location.reload()" class="nav-btn"><i class="bi bi-box-arrow-right"></i>ออก</a>
        </div>
    </div>

    <div class="modal fade" id="m" tabindex="-1"><div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content"><div class="modal-header bg-success text-white"><h5>ข้อมูลทรัพย์</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div id="mb" class="modal-body"></div></div>
    </div></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const API = "https://script.google.com/macros/s/AKfycbwSuBmFRK8OKfsBPt_XEeAYHPg2uW_qc1cwh2lIR5yUQB6q5r1VyNnhUqieH_BKRH08qA/exec";
        const AD_PH = "0812345678"; const AD_PW = "Admin1234";
        let isAd = false; let store = [];

        function login() {
            const u = document.getElementById('u').value; const p = document.getElementById('p').value;
            if(!u || !p) return alert("กรุณากรอกข้อมูล");
            isAd = (u === AD_PH && p === AD_PW);
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('app').style.display = 'block';
            load();
        }

        async function load() {
            try {
                const r = await fetch(API + "?action=read");
                store = await r.json();
                let h = '';
                store.forEach((it, i) => {
                    h += `<div class="prop-item"><img src="${it.image_url}" class="thumb" onerror="this.src='https://via.placeholder.com/100'">
                          <div class="info"><h6>${it.property_id} <span class="badge bg-light text-success border border-success">${it.status || 'available'}</span></h6>
                          <div class="price">฿ ${it.price || '-'}</div><div class="mt-2">
                          <button class="btn btn-success btn-sm py-0" onclick="pop(${i})">รายละเอียด</button>
                          ${isAd ? `<a href="${API}" target="_blank" class="btn btn-warning btn-sm py-0 ms-1">Admin</a>` : ''}
                          </div></div></div>`;
                });
                document.getElementById('list').innerHTML = h;
            } catch (e) { document.getElementById('list').innerHTML = "โหลดล้มเหลว"; }
        }

        function pop(i) {
            const it = store[i]; let c = '<div class="row">';
            for (let k in it) { c += `<div class="col-6 mb-2 border-bottom"><strong>${k}:</strong><br>${it[k] || '-'}</div>`; }
            c += '</div>'; document.getElementById('mb').innerHTML = c;
            new bootstrap.Modal(document.getElementById('m')).show();
        }
    </script>
</body>
</html>
